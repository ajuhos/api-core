{"version":3,"file":"ApiEdgeDefinition.js","sourceRoot":"","sources":["../../../src/edge/ApiEdgeDefinition.ts"],"names":[],"mappings":";AAIA,8BAAgD,iBAAiB,CAAC,CAAA;AAqBlE;IAAA;QAAA,iBA+CC;QA7BG,eAAU,GAAG,UAAC,IAAY,EAAE,OAAyD;YACjF,EAAE,CAAA,CAAC,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAC,MAAqB;gBACvC,OAAA,MAAM,CAAC,IAAI,KAAK,IAAI;oBACpB,MAAM,CAAC,KAAK,IAAI,kCAAkB,CAAC,IAAI;YADvC,CACuC,CAAC,CAAC;gBAC1C,MAAM,mDAAmD,CAAC;YAE7D,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,6BAAa,CAAC,IAAI,EAAE,OAAO,EAAE,kCAAkB,CAAC,IAAI,CAAC,CAAC,CAAC;YAC7E,MAAM,CAAC,KAAI,CAAA;QACf,CAAC,CAAC;QAEF,qBAAgB,GAAG,UAAC,IAAY,EAAE,OAAyD;YACvF,EAAE,CAAA,CAAC,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAC,MAAqB;gBACvC,OAAA,MAAM,CAAC,IAAI,KAAK,IAAI;oBACpB,MAAM,CAAC,KAAK,IAAI,kCAAkB,CAAC,UAAU;YAD7C,CAC6C,CAAC,CAAC;gBAC/C,MAAM,wDAAwD,CAAC;YAEnE,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,6BAAa,CAAC,IAAI,EAAE,OAAO,EAAE,kCAAkB,CAAC,UAAU,CAAC,CAAC,CAAC;YACnF,MAAM,CAAC,KAAI,CAAA;QACf,CAAC,CAAC;QAEF,gBAAW,GAAG,UAAC,IAAY,EAAE,OAAyD;YAClF,EAAE,CAAA,CAAC,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAC,MAAqB;gBACvC,OAAA,MAAM,CAAC,IAAI,KAAK,IAAI;oBACpB,MAAM,CAAC,KAAK,IAAI,kCAAkB,CAAC,KAAK;YADxC,CACwC,CAAC,CAAC;gBAC1C,MAAM,oDAAoD,CAAC;YAE/D,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,6BAAa,CAAC,IAAI,EAAE,OAAO,EAAE,kCAAkB,CAAC,KAAK,CAAC,CAAC,CAAC;YAC9E,MAAM,CAAC,KAAI,CAAA;QACf,CAAC,CAAC;IACN,CAAC;IAAD,cAAC;AAAD,CAAC,AA/CD,IA+CC;AA/CqB,eAAO,UA+C5B,CAAA","sourcesContent":["import {ApiEdgeRelation} from \"../relations/ApiEdgeRelation\";\nimport {ApiEdgeQueryContext} from \"./ApiEdgeQueryContext\";\nimport {ApiEdgeQueryResponse} from \"./ApiEdgeQueryResponse\";\nimport {ApiQueryScope} from \"../query/ApiQuery\";\nimport {ApiEdgeMethod, ApiEdgeMethodScope} from \"./ApiEdgeMethod\";\n\nexport interface ApiEdgeDefinition {\n    name: string;\n    pluralName: string;\n    idField: string;\n\n    fields: string[];\n    methods: ApiEdgeMethod[];\n    relations: ApiEdgeRelation[];\n\n    getEntry: (context: ApiEdgeQueryContext) => Promise<ApiEdgeQueryResponse>;\n    listEntries: (context: ApiEdgeQueryContext) => Promise<ApiEdgeQueryResponse>;\n    createEntry: (context: ApiEdgeQueryContext, entryFields: any) => Promise<ApiEdgeQueryResponse>;\n    updateEntry: (context: ApiEdgeQueryContext, entryFields: any) => Promise<ApiEdgeQueryResponse>;\n    patchEntry: (context: ApiEdgeQueryContext, entryFields: any) => Promise<ApiEdgeQueryResponse>;\n    removeEntry: (context: ApiEdgeQueryContext, entryFields: any) => Promise<ApiEdgeQueryResponse>;\n    exists: (context: ApiEdgeQueryContext) => Promise<ApiEdgeQueryResponse>;\n    callMethod: (scope: ApiQueryScope) => Promise<ApiQueryScope>;\n}\n\nexport abstract class ApiEdge implements ApiEdgeDefinition {\n    name: string;\n    pluralName: string;\n    idField: string;\n\n    fields: string[];\n    methods: ApiEdgeMethod[];\n    relations: ApiEdgeRelation[];\n\n    getEntry: (context: ApiEdgeQueryContext) => Promise<ApiEdgeQueryResponse>;\n    listEntries: (context: ApiEdgeQueryContext) => Promise<ApiEdgeQueryResponse>;\n    createEntry: (context: ApiEdgeQueryContext, entryFields: any) => Promise<ApiEdgeQueryResponse>;\n    updateEntry: (context: ApiEdgeQueryContext, entryFields: any) => Promise<ApiEdgeQueryResponse>;\n    patchEntry: (context: ApiEdgeQueryContext, entryFields: any) => Promise<ApiEdgeQueryResponse>;\n    removeEntry: (context: ApiEdgeQueryContext, entryFields: any) => Promise<ApiEdgeQueryResponse>;\n    exists: (context: ApiEdgeQueryContext) => Promise<ApiEdgeQueryResponse>;\n    callMethod: (scope: ApiQueryScope) => Promise<ApiQueryScope>;\n\n    edgeMethod = (name: string, execute: (scope: ApiQueryScope) => Promise<ApiQueryScope>): ApiEdge => {\n        if(this.methods.find((method: ApiEdgeMethod) =>\n            method.name === name &&\n            method.scope == ApiEdgeMethodScope.Edge))\n           throw \"An edge method with the same name already exists.\";\n\n        this.methods.push(new ApiEdgeMethod(name, execute, ApiEdgeMethodScope.Edge));\n        return this\n    };\n\n    collectionMethod = (name: string, execute: (scope: ApiQueryScope) => Promise<ApiQueryScope>): ApiEdge => {\n        if(this.methods.find((method: ApiEdgeMethod) =>\n            method.name === name &&\n            method.scope == ApiEdgeMethodScope.Collection))\n            throw \"A collection method with the same name already exists.\";\n\n        this.methods.push(new ApiEdgeMethod(name, execute, ApiEdgeMethodScope.Collection));\n        return this\n    };\n\n    entryMethod = (name: string, execute: (scope: ApiQueryScope) => Promise<ApiQueryScope>): ApiEdge => {\n        if(this.methods.find((method: ApiEdgeMethod) =>\n            method.name === name &&\n            method.scope == ApiEdgeMethodScope.Entry))\n            throw \"An entry method with the same name already exists.\";\n\n        this.methods.push(new ApiEdgeMethod(name, execute, ApiEdgeMethodScope.Entry));\n        return this\n    };\n}"]}